{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5481a0cf-9f2f-4acc-9996-5fd59903ab54",
   "metadata": {},
   "source": [
    "# Load the dataset\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d5d01b71-84f2-4f16-aa89-1f3d55079ab7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "fba8fc90-f152-4abe-a68d-3539f4b41b55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionID</th>\n",
       "      <th>Name</th>\n",
       "      <th>Date</th>\n",
       "      <th>Transaction Type</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Account Balance</th>\n",
       "      <th>Location</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-01</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>1500</td>\n",
       "      <td>12000</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>2024-11-02</td>\n",
       "      <td>Withdrawal</td>\n",
       "      <td>-200</td>\n",
       "      <td>9800</td>\n",
       "      <td>Chicago</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Michael Lee</td>\n",
       "      <td>2024-11-03</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>500</td>\n",
       "      <td>10500</td>\n",
       "      <td>Los Angeles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Sarah Kim</td>\n",
       "      <td>2024-11-04</td>\n",
       "      <td>Withdrawal</td>\n",
       "      <td>-150</td>\n",
       "      <td>8500</td>\n",
       "      <td>Miami</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-05</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>700</td>\n",
       "      <td>12700</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   TransactionID         Name        Date Transaction Type  Amount  \\\n",
       "0              1     John Doe  2024-11-01          Deposit    1500   \n",
       "1              2   Jane Smith  2024-11-02       Withdrawal    -200   \n",
       "2              3  Michael Lee  2024-11-03          Deposit     500   \n",
       "3              4    Sarah Kim  2024-11-04       Withdrawal    -150   \n",
       "4              5     John Doe  2024-11-05          Deposit     700   \n",
       "\n",
       "   Account Balance     Location  \n",
       "0            12000     New York  \n",
       "1             9800      Chicago  \n",
       "2            10500  Los Angeles  \n",
       "3             8500        Miami  \n",
       "4            12700     New York  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load the dataset using pandas and display the first 5 rows.\n",
    "fin_data=pd.read_csv('finance_data.csv')\n",
    "fin_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74f4a9f8-5c45-4c48-855a-e1e4a4ce8c1b",
   "metadata": {},
   "source": [
    "# Basic statistics\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "2761d8a8-7117-4b82-a1e8-a34d714e7d27",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The total amount deposited and withdrawn is:\n",
      "Transaction Type\n",
      "Deposit       4600\n",
      "Withdrawal   -1050\n",
      "Name: Amount, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# Calculate the total amount deposited and withdrawn.\n",
    "# total_amount=fin_data[(fin_data['Transaction Type']=='Deposit')]\n",
    "# deposit=total_amount.groupby('Transaction Type')['Amount'].sum()\n",
    "# total_amount_withdrawn=fin_data[(fin_data['Transaction Type']=='Withdrawal')].sum()\n",
    "# print(deposit)\n",
    "total=fin_data.groupby('Transaction Type')['Amount'].sum()\n",
    "print(f'The total amount deposited and withdrawn is:\\n{total}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e385c0bb-4f54-4050-916c-4e6207616d48",
   "metadata": {},
   "source": [
    "# Cumulative balance calculation\n",
    "\t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4267f188-3ce7-4040-8a25-ea7017b98ec6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionID</th>\n",
       "      <th>Name</th>\n",
       "      <th>Date</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Account Balance</th>\n",
       "      <th>cumulative_sum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>2024-11-02</td>\n",
       "      <td>-200</td>\n",
       "      <td>9800</td>\n",
       "      <td>9600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>2024-11-06</td>\n",
       "      <td>-300</td>\n",
       "      <td>9500</td>\n",
       "      <td>9300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>2024-11-10</td>\n",
       "      <td>300</td>\n",
       "      <td>9700</td>\n",
       "      <td>9600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-01</td>\n",
       "      <td>1500</td>\n",
       "      <td>12000</td>\n",
       "      <td>13500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-05</td>\n",
       "      <td>700</td>\n",
       "      <td>12700</td>\n",
       "      <td>14200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-09</td>\n",
       "      <td>600</td>\n",
       "      <td>13300</td>\n",
       "      <td>14800</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Michael Lee</td>\n",
       "      <td>2024-11-03</td>\n",
       "      <td>500</td>\n",
       "      <td>10500</td>\n",
       "      <td>11000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Michael Lee</td>\n",
       "      <td>2024-11-07</td>\n",
       "      <td>1000</td>\n",
       "      <td>11500</td>\n",
       "      <td>12000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Sarah Kim</td>\n",
       "      <td>2024-11-04</td>\n",
       "      <td>-150</td>\n",
       "      <td>8500</td>\n",
       "      <td>8350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Sarah Kim</td>\n",
       "      <td>2024-11-08</td>\n",
       "      <td>-400</td>\n",
       "      <td>8100</td>\n",
       "      <td>7950</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   TransactionID         Name        Date  Amount  Account Balance  \\\n",
       "1              2   Jane Smith  2024-11-02    -200             9800   \n",
       "5              6   Jane Smith  2024-11-06    -300             9500   \n",
       "9             10   Jane Smith  2024-11-10     300             9700   \n",
       "0              1     John Doe  2024-11-01    1500            12000   \n",
       "4              5     John Doe  2024-11-05     700            12700   \n",
       "8              9     John Doe  2024-11-09     600            13300   \n",
       "2              3  Michael Lee  2024-11-03     500            10500   \n",
       "6              7  Michael Lee  2024-11-07    1000            11500   \n",
       "3              4    Sarah Kim  2024-11-04    -150             8500   \n",
       "7              8    Sarah Kim  2024-11-08    -400             8100   \n",
       "\n",
       "   cumulative_sum  \n",
       "1            9600  \n",
       "5            9300  \n",
       "9            9600  \n",
       "0           13500  \n",
       "4           14200  \n",
       "8           14800  \n",
       "2           11000  \n",
       "6           12000  \n",
       "3            8350  \n",
       "7            7950  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Use numpy to compute the cumulative sum of transaction amounts for each person to track how their account balances change over time.\n",
    "fin_data_sorted=fin_data.sort_values(by=['Name','Date'])\n",
    "fin_data['cumulative_sum']=fin_data_sorted.groupby('Name')['Amount'].cumsum()+fin_data_sorted.groupby('Name')['Account Balance'].transform('first')\n",
    "\n",
    "display(fin_data_sorted[['TransactionID','Name','Date','Amount','Account Balance','cumulative_sum']])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "07cab1fe-0c9f-4b46-9a90-5594c3d9e6b8",
   "metadata": {},
   "source": [
    "# Filter transactions\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "95e923b1-04b7-4327-8f68-eb21a8522d6f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionID</th>\n",
       "      <th>Name</th>\n",
       "      <th>Date</th>\n",
       "      <th>Transaction Type</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Account Balance</th>\n",
       "      <th>Location</th>\n",
       "      <th>cumulative_sum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-01</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>1500</td>\n",
       "      <td>12000</td>\n",
       "      <td>New York</td>\n",
       "      <td>1500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-05</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>700</td>\n",
       "      <td>12700</td>\n",
       "      <td>New York</td>\n",
       "      <td>2200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Michael Lee</td>\n",
       "      <td>2024-11-07</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>1000</td>\n",
       "      <td>11500</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>1500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>2024-11-09</td>\n",
       "      <td>Deposit</td>\n",
       "      <td>600</td>\n",
       "      <td>13300</td>\n",
       "      <td>New York</td>\n",
       "      <td>2800</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   TransactionID         Name        Date Transaction Type  Amount  \\\n",
       "0              1     John Doe  2024-11-01          Deposit    1500   \n",
       "4              5     John Doe  2024-11-05          Deposit     700   \n",
       "6              7  Michael Lee  2024-11-07          Deposit    1000   \n",
       "8              9     John Doe  2024-11-09          Deposit     600   \n",
       "\n",
       "   Account Balance     Location  cumulative_sum  \n",
       "0            12000     New York            1500  \n",
       "4            12700     New York            2200  \n",
       "6            11500  Los Angeles            1500  \n",
       "8            13300     New York            2800  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Get all transactions where the amount is greater than $500.\n",
    "greater_than_500=fin_data[fin_data['Amount']>500]\n",
    "display(greater_than_500)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a9025a1-b329-4fe2-ad69-776ad0befc1a",
   "metadata": {},
   "source": [
    "# Group by location\n",
    "\t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "57595c86-aaaf-4fe1-b49d-c32c403a66f2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The total transactions is: 10 \n",
      "And the sum of amounts for each location is: \n",
      "Location\n",
      "Chicago        -200\n",
      "Los Angeles    1500\n",
      "Miami          -550\n",
      "New York       2800\n",
      "Name: Amount, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# Find the total number of transactions and the sum of amounts for each location.\n",
    "transaction=fin_data['Transaction Type'].count()\n",
    "sum_of_amounts=fin_data.groupby('Location')['Amount'].sum()\n",
    "print(f'The total transactions is: {transaction} \\nAnd the sum of amounts for each location is: \\n{sum_of_amounts}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "73686914-d5ce-4abf-bc7c-41964ac46e8f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
